# db_hw
Скрипты и результаты их выполнения загружены в папки с заданиями по номерам
Результаты их выполнения представлены в виде скриншотов
## Инструкция по запуску проекта

1. Создайте базу данных в PostgreSQL.

2. Создайте таблицы и заполните их данными (0 скрипт из каждой папки) 

3. После того как таблицы будут созданы и заполнены, можно запускать последующие скрипты для выполнения SQL-запросов соответствующих заданию
## Цели
Написать SQL-скрипты для выполнения нижеперечисленных задач
## Задачи
### 1 Транспортные средства
1. Найдите производителей (maker) и модели всех мотоциклов, которые имеют мощность более 150 лошадиных сил, стоят менее 20 тысяч долларов и являются спортивными (тип Sport). Также отсортируйте результаты по мощности в порядке убывания.
2. Найти информацию о производителях и моделях различных типов транспортных средств (автомобили, мотоциклы и велосипеды), которые соответствуют заданным критериям.
   
### 2 Автомобильные гонки
1. Определить, какие автомобили из каждого класса имеют наименьшую среднюю позицию в гонках, и вывести информацию о каждом таком автомобиле для данного класса, включая его класс, среднюю позицию и количество гонок, в которых он участвовал. Также отсортировать результаты по средней позиции.
2. Определить автомобиль, который имеет наименьшую среднюю позицию в гонках среди всех автомобилей, и вывести информацию об этом автомобиле, включая его класс, среднюю позицию, количество гонок, в которых он участвовал, и страну производства класса автомобиля. Если несколько автомобилей имеют одинаковую наименьшую среднюю позицию, выбрать один из них по алфавиту (по имени автомобиля).
3. Определить классы автомобилей, которые имеют наименьшую среднюю позицию в гонках, и вывести информацию о каждом автомобиле из этих классов, включая его имя, среднюю позицию, количество гонок, в которых он участвовал, страну производства класса автомобиля, а также общее количество гонок, в которых участвовали автомобили этих классов. Если несколько классов имеют одинаковую среднюю позицию, выбрать все из них.
4. Определить, какие автомобили имеют среднюю позицию лучше (меньше) средней позиции всех автомобилей в своем классе (то есть автомобилей в классе должно быть минимум два, чтобы выбрать один из них). Вывести информацию об этих автомобилях, включая их имя, класс, среднюю позицию, количество гонок, в которых они участвовали, и страну производства класса автомобиля. Также отсортировать результаты по классу и затем по средней позиции в порядке возрастания.
5. Определить, какие классы автомобилей имеют наибольшее количество автомобилей с низкой средней позицией (больше 3.0) и вывести информацию о каждом автомобиле из этих классов, включая его имя, класс, среднюю позицию, количество гонок, в которых он участвовал, страну производства класса автомобиля, а также общее количество гонок для каждого класса. Отсортировать результаты по количеству автомобилей с низкой средней позицией.

### 3 Бронирование отелей
1. Определить, какие клиенты сделали более двух бронирований в разных отелях, и вывести информацию о каждом таком клиенте, включая его имя, электронную почту, телефон, общее количество бронирований, а также список отелей, в которых они бронировали номера (объединенные в одно поле через запятую с помощью CONCAT). Также подсчитать среднюю длительность их пребывания (в днях) по всем бронированиям. Отсортировать результаты по количеству бронирований в порядке убывания.
2. Необходимо провести анализ клиентов, которые сделали более двух бронирований в разных отелях и потратили более 500 долларов на свои бронирования.
3. Необходимо провести анализ данных о бронированиях в отелях и определить предпочтения клиентов по типу отелей. Отсортируйте клиентов так, чтобы сначала шли клиенты с «дешевыми» отелями, затем со «средними» и в конце — с «дорогими».
   
### 4 Структура организации
1. Найти всех сотрудников, подчиняющихся Ивану Иванову (с EmployeeID = 1), включая их подчиненных и подчиненных подчиненных. Для каждого сотрудника вывести следующую информацию:
    - EmployeeID: идентификатор сотрудника.
    - Имя сотрудника.
    - ManagerID: Идентификатор менеджера.
    - Название отдела, к которому он принадлежит.
    - Название роли, которую он занимает.
    - Название проектов, к которым он относится (если есть, конкатенированные в одном столбце через запятую).
    - Название задач, назначенных этому сотруднику (если есть, конкатенированные в одном столбце через запятую).
  -Если у сотрудника нет назначенных проектов или задач, отобразить NULL.
2. Найти всех сотрудников, подчиняющихся Ивану Иванову с EmployeeID = 1, включая их подчиненных и подчиненных подчиненных. Для каждого сотрудника вывести следующую информацию:
  - EmployeeID: идентификатор сотрудника.
  - Имя сотрудника.
  - Идентификатор менеджера.
  - Название отдела, к которому он принадлежит.
  - Название роли, которую он занимает.
  - Название проектов, к которым он относится (если есть, конкатенированные в одном столбце).
  - Название задач, назначенных этому сотруднику (если есть, конкатенированные в одном столбце).
  - Общее количество задач, назначенных этому сотруднику.
  - Общее количество подчиненных у каждого сотрудника (не включая подчиненных их подчиненных).
  - Если у сотрудника нет назначенных проектов или задач, отобразить NULL.
3. Найти всех сотрудников, которые занимают роль менеджера и имеют подчиненных (то есть число подчиненных больше 0). Для каждого такого сотрудника вывести следующую информацию:

- EmployeeID: идентификатор сотрудника.
- Имя сотрудника.
- Идентификатор менеджера.
- Название отдела, к которому он принадлежит.
- Название роли, которую он занимает.
- Название проектов, к которым он относится (если есть, конкатенированные в одном столбце).
- Название задач, назначенных этому сотруднику (если есть, конкатенированные в одном столбце).
- Общее количество подчиненных у каждого сотрудника (включая их подчиненных).
- Если у сотрудника нет назначенных проектов или задач, отобразить NULL.
